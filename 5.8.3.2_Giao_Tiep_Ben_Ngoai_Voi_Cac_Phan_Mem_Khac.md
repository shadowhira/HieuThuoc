# 5.8.3.2 Giao tiếp bên ngoài với các Phần mềm khác (SREQ032, SREQ033, SREQ034, SREQ035)

Hệ thống quản lý hiệu thuốc đáp ứng các yêu cầu giao tiếp với các phần mềm bên ngoài sau:

## 1. Giao tiếp với hệ thống thanh toán VNPay (SREQ032)

- Hệ thống tích hợp với cổng thanh toán VNPay để xử lý các giao dịch thanh toán trực tuyến.
- Hệ thống gửi yêu cầu tạo giao dịch thanh toán đến VNPay API và nhận kết quả thanh toán thông qua URL callback.
- Dữ liệu trao đổi bao gồm: mã đơn hàng, số tiền, mô tả giao dịch, thông tin khách hàng, URL callback.
- Định dạng dữ liệu: URL-encoded parameters cho request, JSON cho response.
- Tần suất giao tiếp: Theo nhu cầu, khi khách hàng thực hiện thanh toán trực tuyến.
- Xác thực: Sử dụng HMAC SHA-512 với khóa bí mật được cung cấp bởi VNPay.
- Xử lý lỗi: Hệ thống phải xử lý các trường hợp lỗi từ VNPay và thông báo cho người dùng.

## 2. Giao tiếp với dịch vụ lưu trữ đám mây Cloudinary (SREQ033)

- Hệ thống tích hợp với dịch vụ lưu trữ đám mây Cloudinary để quản lý hình ảnh sản phẩm và avatar người dùng.
- Hệ thống gửi yêu cầu upload, xóa, và truy xuất hình ảnh đến Cloudinary API.
- Dữ liệu trao đổi bao gồm: file hình ảnh, thông tin metadata, thông số biến đổi hình ảnh.
- Định dạng dữ liệu: Multipart/form-data cho upload, JSON cho response và các thao tác khác.
- Tần suất giao tiếp: Khi người dùng thêm/sửa sản phẩm hoặc cập nhật avatar.
- Xác thực: Sử dụng API Key, API Secret và Cloud Name được cung cấp bởi Cloudinary.
- Xử lý lỗi: Hệ thống phải xử lý các trường hợp lỗi từ Cloudinary và cung cấp phương án dự phòng.

## 3. Giao tiếp với dịch vụ email của Gmail (SREQ034)

- Hệ thống tích hợp với dịch vụ SMTP của Gmail để gửi email thông báo, xác nhận đơn hàng và đặt lại mật khẩu.
- Hệ thống gửi yêu cầu gửi email đến máy chủ SMTP của Gmail.
- Dữ liệu trao đổi bao gồm: địa chỉ email người nhận, tiêu đề, nội dung email (HTML/text).
- Định dạng dữ liệu: MIME (Multipurpose Internet Mail Extensions).
- Tần suất giao tiếp: Khi cần gửi thông báo, xác nhận đơn hàng, hoặc đặt lại mật khẩu.
- Xác thực: Sử dụng tài khoản Gmail và mật khẩu ứng dụng.
- Xử lý lỗi: Hệ thống phải xử lý các trường hợp lỗi khi gửi email và cung cấp phương án dự phòng.

## 4. Giao tiếp với thư viện xuất báo cáo (SREQ035)

- Hệ thống tích hợp với thư viện xuất báo cáo để tạo báo cáo dạng PDF và Excel.
- Hệ thống sử dụng các API của thư viện để tạo và định dạng báo cáo.
- Dữ liệu trao đổi bao gồm: dữ liệu báo cáo, cấu trúc báo cáo, định dạng xuất.
- Định dạng dữ liệu: Đối tượng Java/TypeScript cho input, PDF/Excel cho output.
- Tần suất giao tiếp: Khi người dùng yêu cầu xuất báo cáo.
- Xử lý lỗi: Hệ thống phải xử lý các trường hợp lỗi khi tạo báo cáo và thông báo cho người dùng.

## 5. Giao tiếp với cơ sở dữ liệu tương tác thuốc (SREQ036)

- Hệ thống tích hợp với cơ sở dữ liệu tương tác thuốc để kiểm tra và cảnh báo tương tác giữa các loại thuốc.
- Hệ thống gửi yêu cầu kiểm tra tương tác giữa các hoạt chất đến cơ sở dữ liệu.
- Dữ liệu trao đổi bao gồm: danh sách hoạt chất cần kiểm tra.
- Định dạng dữ liệu: JSON cho cả request và response.
- Tần suất giao tiếp: Khi khách hàng thêm thuốc vào giỏ hàng hoặc khi tạo đơn hàng.
- Xử lý lỗi: Hệ thống phải xử lý các trường hợp không tìm thấy thông tin tương tác và cung cấp thông báo phù hợp.

## 6. Khả năng mở rộng tích hợp với các hệ thống khác

- Hệ thống được thiết kế với kiến trúc mở để có thể tích hợp với các hệ thống khác trong tương lai.
- Hệ thống có khả năng tích hợp với các hệ thống quản lý kho bên ngoài.
- Hệ thống có khả năng tích hợp với các cổng thanh toán khác ngoài VNPay.
- Hệ thống có khả năng tích hợp với các dịch vụ gửi SMS để gửi thông báo đến người dùng.
- Hệ thống có khả năng tích hợp với các hệ thống kế toán để đồng bộ dữ liệu tài chính.
